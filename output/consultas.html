
<!doctype html>
<html lang="pt-br" class="h-full">
 <head>
  <meta charset="utf-8">
  <title>SQL DocGen</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&amp;family=Space+Grotesk:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
  <script src="/_sdk/element_sdk.js"></script>
  <style>
body {
  box-sizing: border-box;
}

:root {
  --bg-primary: #000000;
  --bg-card: #0a0a0f;
  --bg-elevated: #12121a;
  --accent-blue: #00d4ff;
  --accent-purple: #a855f7;
  --accent-cyan: #06b6d4;
  --accent-emerald: #10b981;
  --accent-amber: #fbbf24;
  --accent-rose: #f43f5e;
  --text-primary: #ffffff;
  --text-secondary: #94a3b8;
  --text-muted: #64748b;
  --border: rgba(255, 255, 255, 0.05);
  --glow-blue: rgba(0, 212, 255, 0.4);
  --glow-purple: rgba(168, 85, 247, 0.3);
}

* {
  scrollbar-width: thin;
  scrollbar-color: var(--accent-blue) var(--bg-card);
}

*::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

*::-webkit-scrollbar-track {
  background: var(--bg-card);
}

*::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, var(--accent-blue), var(--accent-purple));
  border-radius: 4px;
}

*::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(180deg, var(--accent-purple), var(--accent-blue));
}

.font-display {
  font-family: 'Space Grotesk', system-ui, sans-serif;
}

.font-mono {
  font-family: 'JetBrains Mono', monospace;
}

.gradient-text {
  background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple), var(--accent-cyan));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  animation: gradientShift 8s ease infinite;
  background-size: 200% 200%;
}

@keyframes gradientShift {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

.gradient-border {
  position: relative;
  background: var(--bg-card);
  border-radius: 20px;
  overflow: hidden;
}

.gradient-border::before {
  content: '';
  position: absolute;
  inset: -2px;
  border-radius: 20px;
  padding: 2px;
  background: linear-gradient(
    135deg,
    var(--accent-blue),
    var(--accent-purple),
    var(--accent-cyan),
    var(--accent-blue)
  );
  background-size: 300% 300%;

  /* Standard (required for linters & specs) */
  mask: linear-gradient(#fff 0 0) content-box,
        linear-gradient(#fff 0 0);
  mask-composite: exclude;

  /* WebKit fallback */
  -webkit-mask: linear-gradient(#fff 0 0) content-box,
                linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;

  pointer-events: none;
  animation: borderFlow 4s ease infinite;
}


@keyframes borderFlow {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

.card-glow {
  position: relative;
  box-shadow: 
    0 0 60px -15px var(--glow-blue),
    0 0 100px -40px var(--glow-purple),
    inset 0 1px 0 rgba(255, 255, 255, 0.05);
  transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

.card-glow::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 1px;
  background: linear-gradient(90deg, transparent, var(--accent-blue), transparent);
  opacity: 0;
  transition: opacity 0.5s ease;
}

.card-glow:hover {
  box-shadow: 
    0 0 80px -10px var(--glow-blue),
    0 0 120px -30px var(--glow-purple),
    inset 0 1px 0 rgba(255, 255, 255, 0.1);
  transform: translateY(-4px) scale(1.01);
}

.card-glow:hover::after {
  opacity: 1;
}

.badge-type {
  background: linear-gradient(135deg, rgba(0, 212, 255, 0.2), rgba(168, 85, 247, 0.2));
  border: 1px solid rgba(0, 212, 255, 0.4);
  color: var(--accent-blue);
  box-shadow: 0 0 20px -5px var(--glow-blue);
  backdrop-filter: blur(10px);
  transition: all 0.3s ease;
}

.badge-type:hover {
  box-shadow: 0 0 30px -5px var(--glow-blue);
  transform: translateY(-1px);
}

.badge-complexity-baixa {
  background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(6, 182, 212, 0.2));
  border: 1px solid rgba(16, 185, 129, 0.4);
  color: var(--accent-emerald);
  box-shadow: 0 0 20px -5px rgba(16, 185, 129, 0.3);
  backdrop-filter: blur(10px);
}

.badge-complexity-media {
  background: linear-gradient(135deg, rgba(251, 191, 36, 0.2), rgba(244, 63, 94, 0.2));
  border: 1px solid rgba(251, 191, 36, 0.4);
  color: var(--accent-amber);
  box-shadow: 0 0 20px -5px rgba(251, 191, 36, 0.3);
  backdrop-filter: blur(10px);
}

.badge-complexity-alta {
  background: linear-gradient(135deg, rgba(244, 63, 94, 0.2), rgba(168, 85, 247, 0.2));
  border: 1px solid rgba(244, 63, 94, 0.4);
  color: var(--accent-rose);
  box-shadow: 0 0 20px -5px rgba(244, 63, 94, 0.3);
  backdrop-filter: blur(10px);
}

.sql-block {
  background: linear-gradient(180deg, #000000 0%, #0a0a0f 100%);
  border: 1px solid rgba(0, 212, 255, 0.2);
  position: relative;
  overflow: hidden;
  box-shadow: 
    0 0 40px -10px var(--glow-blue),
    inset 0 1px 0 rgba(0, 212, 255, 0.1);
}

.sql-block::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 2px;
  background: linear-gradient(90deg, transparent, var(--accent-blue), transparent);
  animation: scanLine 3s ease-in-out infinite;
}

@keyframes scanLine {
  0% { left: -100%; }
  100% { left: 200%; }
}

.sql-header {
  background: linear-gradient(135deg, rgba(0, 212, 255, 0.05), rgba(168, 85, 247, 0.05));
  border-bottom: 1px solid rgba(0, 212, 255, 0.2);
  backdrop-filter: blur(10px);
}

.line-number {
  color: var(--text-muted);
  user-select: none;
  text-align: right;
  padding-right: 16px;
  border-right: 1px solid rgba(0, 212, 255, 0.1);
  min-width: 40px;
}

.sql-keyword { color: #ff6b9d; font-weight: 600; text-shadow: 0 0 10px rgba(255, 107, 157, 0.3); }
.sql-function { color: #c792ea; font-weight: 500; text-shadow: 0 0 10px rgba(199, 146, 234, 0.3); }
.sql-string { color: #00d4ff; text-shadow: 0 0 10px rgba(0, 212, 255, 0.3); }
.sql-number { color: #a5f3fc; text-shadow: 0 0 10px rgba(165, 243, 252, 0.3); }
.sql-comment { color: #64748b; font-style: italic; }
.sql-table { color: #10b981; font-weight: 500; text-shadow: 0 0 10px rgba(16, 185, 129, 0.3); }
.sql-column { color: #fbbf24; text-shadow: 0 0 10px rgba(251, 191, 36, 0.3); }

.metric-card {
  background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), rgba(168, 85, 247, 0.05));
  border: 1px solid rgba(0, 212, 255, 0.3);
  backdrop-filter: blur(10px);
  transition: all 0.3s ease;
}

.metric-card:hover {
  background: linear-gradient(135deg, rgba(0, 212, 255, 0.15), rgba(168, 85, 247, 0.1));
  box-shadow: 0 0 20px -5px var(--glow-blue);
  transform: translateY(-2px);
}

.dimension-card {
  background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(6, 182, 212, 0.05));
  border: 1px solid rgba(16, 185, 129, 0.3);
  backdrop-filter: blur(10px);
  transition: all 0.3s ease;
}

.dimension-card:hover {
  background: linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(6, 182, 212, 0.1));
  box-shadow: 0 0 20px -5px rgba(16, 185, 129, 0.3);
  transform: translateY(-2px);
}

.table-pill {
  background: linear-gradient(135deg, rgba(251, 191, 36, 0.15), rgba(244, 63, 94, 0.05));
  border: 1px solid rgba(251, 191, 36, 0.3);
  backdrop-filter: blur(10px);
  transition: all 0.3s ease;
  cursor: default;
}

.table-pill:hover {
  background: linear-gradient(135deg, rgba(251, 191, 36, 0.2), rgba(244, 63, 94, 0.1));
  box-shadow: 0 0 20px -5px rgba(251, 191, 36, 0.3);
  transform: translateY(-1px);
}

.sidebar-item {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}

.sidebar-item::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 3px;
  background: linear-gradient(180deg, var(--accent-blue), var(--accent-purple));
  transform: translateX(-3px);
  transition: transform 0.3s ease;
}

.sidebar-item:hover {
  background: rgba(0, 212, 255, 0.08);
}

.sidebar-item:hover::before {
  transform: translateX(0);
}

.sidebar-item.active {
  background: rgba(0, 212, 255, 0.12);
  box-shadow: inset 0 0 20px -5px var(--glow-blue);
}

.sidebar-item.active::before {
  transform: translateX(0);
}

.pulse-dot {
  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

.stats-card {
  background: linear-gradient(135deg, var(--bg-elevated), var(--bg-card));
  border: 1px solid var(--border);
}

.copy-btn {
  opacity: 0;
  transition: opacity 0.2s ease;
}

.sql-block:hover .copy-btn {
  opacity: 1;
}

.search-input {
  background: var(--bg-elevated);
  border: 1px solid var(--border);
  transition: all 0.2s ease;
}

.search-input:focus {
  border-color: var(--accent-blue);
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
}

.fade-in {
  animation: fadeIn 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

.stagger-1 { animation-delay: 0.1s; }
.stagger-2 { animation-delay: 0.2s; }
.stagger-3 { animation-delay: 0.3s; }
.stagger-4 { animation-delay: 0.4s; }

.particle {
  position: fixed;
  width: 2px;
  height: 2px;
  background: var(--accent-blue);
  border-radius: 50%;
  pointer-events: none;
  opacity: 0;
  z-index: 0;
}

@keyframes float {
  0% {
    transform: translateY(100vh) translateX(0) scale(0);
    opacity: 0;
  }
  10% {
    opacity: 0.5;
  }
  90% {
    opacity: 0.5;
  }
  100% {
    transform: translateY(-100px) translateX(100px) scale(1);
    opacity: 0;
  }
}

.grid-bg {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-image: 
    linear-gradient(rgba(0, 212, 255, 0.03) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0, 212, 255, 0.03) 1px, transparent 1px);
  background-size: 50px 50px;
  pointer-events: none;
  z-index: 0;
}

.spotlight {
  position: fixed;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle at center, 
    rgba(0, 212, 255, 0.08) 0%, 
    rgba(168, 85, 247, 0.04) 25%,
    transparent 50%);
  pointer-events: none;
  z-index: 0;
  animation: spotlight 20s ease-in-out infinite;
}

@keyframes spotlight {
  0%, 100% { transform: translate(0, 0) scale(1); }
  33% { transform: translate(10%, 10%) scale(1.1); }
  66% { transform: translate(-10%, 5%) scale(0.9); }
}
</style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full" style="background: var(--bg-primary); color: var(--text-primary);"><!-- Background Effects -->
  <div class="spotlight"></div>
  <div class="grid-bg"></div>
  <div class="h-full flex overflow-auto" style="position: relative; z-index: 1;"><!-- Sidebar -->
   <aside class="w-72 flex-shrink-0 border-r flex flex-col" style="background: var(--bg-card); border-color: var(--border);"><!-- Logo -->
    <div class="p-6 border-b" style="border-color: var(--border);">
     <div class="flex items-center gap-3">
      <div class="w-10 h-10 rounded-xl flex items-center justify-center" style="background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));">
       <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4" />
       </svg>
      </div>
      <div>
       <h1 id="page-title" class="font-display font-bold text-lg gradient-text">SQL DocGen</h1>
       <p id="subtitle" class="text-xs" style="color: var(--text-muted);">Documentação automática</p>
      </div>
     </div>
    </div><!-- Search -->
    <div class="p-4">
     <div class="relative">
      <svg class="w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2" style="color: var(--text-muted);" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
      </svg><input id="search-input" type="text" placeholder="Buscar queries..." class="search-input w-full pl-10 pr-4 py-2.5 rounded-lg text-sm font-mono outline-none" style="color: var(--text-primary);">
     </div>
    </div><!-- Stats -->
    <div class="px-4 pb-4 grid grid-cols-2 gap-2">
     <div class="stats-card rounded-lg p-3 text-center">
      <div id="total-queries" class="font-display font-bold text-xl" style="color: var(--accent-blue);">
       4
      </div>
      <div class="text-xs" style="color: var(--text-muted);">
       Queries
      </div>
     </div>
     <div class="stats-card rounded-lg p-3 text-center">
      <div id="total-tables" class="font-display font-bold text-xl" style="color: var(--accent-emerald);">
       8
      </div>
      <div class="text-xs" style="color: var(--text-muted);">
       Tabelas
      </div>
     </div>
    </div><!-- Query List -->
    <nav class="flex-1 overflow-y-auto px-2">
     <div class="px-2 py-2 text-xs font-semibold uppercase tracking-wider" style="color: var(--text-muted);">
      Queries
     </div>
     <div id="query-nav" class="space-y-1"><!-- Populated by JS -->
     </div>
    </nav><!-- Footer -->
    <div class="p-4 border-t" style="border-color: var(--border);">
     <div class="flex items-center gap-2 text-xs" style="color: var(--text-muted);">
      <div class="w-2 h-2 rounded-full pulse-dot" style="background: var(--accent-emerald);"></div><span id="generated-at">Gerado em 04/01/2025 15:30</span>
     </div>
    </div>
   </aside><!-- Main Content -->
   <main class="flex-1 overflow-y-auto"><!-- Header -->
    <header class="sticky top-0 z-10 backdrop-blur-xl border-b" style="background: rgba(10, 10, 15, 0.8); border-color: var(--border);">
     <div class="px-8 py-4 flex items-center justify-between">
      <div>
       <h2 class="font-display font-semibold text-lg" style="color: var(--text-primary);">Documentação de Queries</h2>
       <p class="text-sm" style="color: var(--text-secondary);">Análise estrutural baseada em sqlglot</p>
      </div>
      <div class="flex items-center gap-3"><button id="filter-all" class="filter-btn px-4 py-2 rounded-lg text-sm font-medium transition-all" style="background: var(--accent-blue); color: white;"> Todas </button> <button id="filter-select" class="filter-btn px-4 py-2 rounded-lg text-sm font-medium transition-all" style="background: var(--bg-elevated); color: var(--text-secondary);"> SELECT </button> <button id="filter-insert" class="filter-btn px-4 py-2 rounded-lg text-sm font-medium transition-all" style="background: var(--bg-elevated); color: var(--text-secondary);"> INSERT </button> <button id="filter-update" class="filter-btn px-4 py-2 rounded-lg text-sm font-medium transition-all" style="background: var(--bg-elevated); color: var(--text-secondary);"> UPDATE </button>
      </div>
     </div>
    </header><!-- Cards Container -->
    <div id="cards-container" class="p-8 space-y-8"><!-- Cards populated by JS -->
    </div>
   </main>
  </div>
  <script>
    
// Sample data - this would be injected by Python
     let filtered = queries;
     const sampleQuconsteries = JSON.parse(sampleQueriesJSON);

// Default configuration
const defaultConfig = {
  page_title: 'SQL DocGen',
  subtitle: 'Documentação automática',
  primary_color: '#3b82f6',
  secondary_color: '#8b5cf6',
  accent_color: '#10b981',
  bg_color: '#0a0a0f',
  text_color: '#f1f5f9',
  font_family: 'Space Grotesk',
  font_size: 16
};

let config = { ...defaultConfig };
let currentFilter = 'all';
let searchTerm = '';

// Syntax highlighting for SQL
function highlightSQL(sql) {
  const keywords = ['SELECT', 'FROM', 'WHERE', 'AND', 'OR', 'JOIN', 'INNER', 'LEFT', 'RIGHT', 'OUTER', 'ON', 'GROUP', 'BY', 'ORDER', 'HAVING', 'LIMIT', 'OFFSET', 'AS', 'DISTINCT', 'COUNT', 'SUM', 'AVG', 'MAX', 'MIN', 'CASE', 'WHEN', 'THEN', 'ELSE', 'END', 'INSERT', 'INTO', 'VALUES', 'UPDATE', 'SET', 'DELETE', 'CREATE', 'ALTER', 'DROP', 'TABLE', 'INDEX', 'VIEW', 'WITH', 'UNION', 'ALL', 'EXISTS', 'IN', 'NOT', 'NULL', 'IS', 'BETWEEN', 'LIKE', 'OVER', 'PARTITION', 'INTERVAL', 'DATE', 'CURRENT_DATE', 'CURRENT_TIMESTAMP', 'TRUE', 'FALSE', 'ASC', 'DESC', 'ROUND', 'LAG', 'UUID', 'DATEDIFF', 'DATE_SUB', 'DAY', 'YEAR'];
  
  let escaped = sql.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
  
  // Comments
  escaped = escaped.replace(/(--.*$)/gm, '<span class="sql-comment">$1</span>');
  
  // Strings
  escaped = escaped.replace(/('(?:[^'\\]|\\.)*')/g, '<span class="sql-string">$1</span>');
  
  // Numbers
  escaped = escaped.replace(/\b(\d+\.?\d*)\b/g, '<span class="sql-number">$1</span>');
  
  // Keywords
  keywords.forEach(kw => {
    const regex = new RegExp(`\\b(${kw})\\b`, 'gi');
    escaped = escaped.replace(regex, '<span class="sql-keyword">$1</span>');
  });
  
  // Parameters
  escaped = escaped.replace(/(:\w+)/g, '<span class="sql-column">$1</span>');
  
  return escaped;
}

function getComplexityClass(complexity) {
  const c = complexity.toLowerCase();
  if (c === 'baixa' || c === 'low') return 'badge-complexity-baixa';
  if (c === 'média' || c === 'media' || c === 'medium') return 'badge-complexity-media';
  return 'badge-complexity-alta';
}

function renderCard(query, index) {
  const sqlLines = query.sql.trim().split('\n');
  const highlightedLines = sqlLines.map((line, i) => 
    `<tr><td class="line-number pr-4 py-0.5">${i + 1}</td><td class="pl-4 py-0.5">${highlightSQL(line)}</td></tr>`
  ).join('');

  const tablesHtml = query.tabelas.map(t => 
    `<span class="table-pill px-3 py-1.5 rounded-lg text-xs font-mono" style="color: var(--accent-amber);">${t}</span>`
  ).join('');

  const metricsHtml = query.metricas.length ? query.metricas.map(m => 
    `<div class="metric-card px-3 py-2 rounded-lg">
      <span class="text-xs font-mono" style="color: var(--accent-blue);">${m}</span>
    </div>`
  ).join('') : '<span class="text-sm" style="color: var(--text-muted);">—</span>';

  const dimensionsHtml = query.dimensoes.length ? query.dimensoes.map(d => 
    `<div class="dimension-card px-3 py-2 rounded-lg">
      <span class="text-xs font-mono" style="color: var(--accent-emerald);">${d}</span>
    </div>`
  ).join('') : '<span class="text-sm" style="color: var(--text-muted);">—</span>';

  return `
    <article id="query-${index}" class="gradient-border card-glow fade-in stagger-${(index % 4) + 1}" style="opacity: 0;">
      <div class="p-6">
        <!-- Header -->
        <div class="flex items-start justify-between mb-4">
          <div class="flex items-center gap-4">
            <div class="w-12 h-12 rounded-xl flex items-center justify-center font-display font-bold text-lg" 
                 style="background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple)); color: white;">
              ${index}
            </div>
            <div>
              <h3 class="font-display font-semibold text-xl" style="color: var(--text-primary);">${query.titulo}</h3>
              <p class="text-sm font-mono" style="color: var(--text-muted);">${query.arquivo}</p>
            </div>
          </div>
          <div class="flex gap-2">
            <span class="badge-type px-3 py-1.5 rounded-full text-xs font-semibold">${query.tipo}</span>
            <span class="${getComplexityClass(query.complexidade)} px-3 py-1.5 rounded-full text-xs font-semibold">${query.complexidade}</span>
          </div>
        </div>

        <!-- Description -->
        <p class="mb-6 leading-relaxed" style="color: var(--text-secondary);">${query.descricao}</p>

        <!-- Tables -->
        <div class="mb-6">
          <h4 class="text-xs font-semibold uppercase tracking-wider mb-3" style="color: var(--text-muted);">
            <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"/>
            </svg>
            Tabelas
          </h4>
          <div class="flex flex-wrap gap-2">${tablesHtml}</div>
        </div>

        <!-- Metrics & Dimensions -->
        <div class="grid grid-cols-2 gap-6 mb-6">
          <div>
            <h4 class="text-xs font-semibold uppercase tracking-wider mb-3" style="color: var(--text-muted);">
              <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
              </svg>
              Métricas
            </h4>
            <div class="flex flex-wrap gap-2">${metricsHtml}</div>
          </div>
          <div>
            <h4 class="text-xs font-semibold uppercase tracking-wider mb-3" style="color: var(--text-muted);">
              <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"/>
              </svg>
              Dimensões
            </h4>
            <div class="flex flex-wrap gap-2">${dimensionsHtml}</div>
          </div>
        </div>

        <!-- SQL Block -->
        <div class="sql-block rounded-xl overflow-hidden">
          <div class="sql-header px-4 py-3 flex items-center justify-between">
            <div class="flex items-center gap-2">
              <div class="w-3 h-3 rounded-full" style="background: #ff5f56;"></div>
              <div class="w-3 h-3 rounded-full" style="background: #ffbd2e;"></div>
              <div class="w-3 h-3 rounded-full" style="background: #27ca40;"></div>
              <span class="ml-3 text-xs font-mono" style="color: var(--text-muted);">SQL</span>
            </div>
            <button class="copy-btn px-3 py-1.5 rounded-lg text-xs font-medium transition-all hover:bg-opacity-80" 
                    style="background: var(--accent-blue); color: white;"
                    onclick="copySQL(${index})">
              <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
              </svg>
              Copiar
            </button>
          </div>
          <div class="p-4 overflow-x-auto">
            <table class="font-mono text-sm w-full" style="color: var(--text-primary);">
              <tbody>${highlightedLines}</tbody>
            </table>
          </div>
        </div>
      </div>
    </article>
  `;
}

function renderNav(queries) {
  return queries.map((q, i) => `
    <a href="#query-${i + 1}" class="sidebar-item block px-4 py-3 rounded-lg border-l-2 border-transparent cursor-pointer">
      <div class="flex items-center gap-3">
        <span class="w-6 h-6 rounded-md flex items-center justify-center text-xs font-semibold" 
              style="background: var(--bg-elevated); color: var(--text-secondary);">${i + 1}</span>
        <div class="flex-1 min-w-0">
          <div class="text-sm font-medium truncate" style="color: var(--text-primary);">${q.titulo}</div>
          <div class="text-xs truncate" style="color: var(--text-muted);">${q.tipo}</div>
        </div>
      </div>
    </a>
  `).join('');
}

function filterQueries() {
  let filtered = sampleQueries;
  
  if (currentFilter !== 'all') {
    filtered = filtered.filter(q => q.tipo.toUpperCase() === currentFilter.toUpperCase());
  }
  
  if (searchTerm) {
    const term = searchTerm.toLowerCase();
    filtered = filtered.filter(q => 
      q.titulo.toLowerCase().includes(term) ||
      q.descricao.toLowerCase().includes(term) ||
      q.tabelas.some(t => t.toLowerCase().includes(term)) ||
      q.metricas.some(m => m.toLowerCase().includes(term))
    );
  }
  
  return filtered;
}

function renderAll() {
  const filtered = filterQueries();
  document.getElementById('cards-container').innerHTML = filtered.length 
    ? filtered.map((q, i) => renderCard(q, i + 1)).join('')
    : '<div class="text-center py-20"><p style="color: var(--text-muted);">Nenhuma query encontrada.</p></div>';
  
  document.getElementById('query-nav').innerHTML = renderNav(filtered);
  document.getElementById('total-queries').textContent = filtered.length;
  
  const allTables = [...new Set(filtered.flatMap(q => q.tabelas))];
  document.getElementById('total-tables').textContent = allTables.length;
}

function copySQL(index) {
  const query = filterQueries()[index - 1];
  if (query) {
    navigator.clipboard.writeText(query.sql).then(() => {
      const btn = event.target.closest('button');
      const originalText = btn.innerHTML;
      btn.innerHTML = '<svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>Copiado!';
      btn.style.background = 'var(--accent-emerald)';
      setTimeout(() => {
        btn.innerHTML = originalText;
        btn.style.background = 'var(--accent-blue)';
      }, 2000);
    });
  }
}

// Filter buttons
document.querySelectorAll('.filter-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.filter-btn').forEach(b => {
      b.style.background = 'var(--bg-elevated)';
      b.style.color = 'var(--text-secondary)';
    });
    btn.style.background = 'var(--accent-blue)';
    btn.style.color = 'white';
    
    currentFilter = btn.id.replace('filter-', '');
    renderAll();
  });
});

// Search
document.getElementById('search-input').addEventListener('input', (e) => {
  searchTerm = e.target.value;
  renderAll();
});

// Element SDK integration
async function onConfigChange(cfg) {
  const customFont = cfg.font_family || defaultConfig.font_family;
  
  document.getElementById('page-title').textContent = cfg.page_title || defaultConfig.page_title;
  document.getElementById('subtitle').textContent = cfg.subtitle || defaultConfig.subtitle;
  
  document.querySelectorAll('.font-display').forEach(el => {
    el.style.fontFamily = `${customFont}, system-ui, sans-serif`;
  });
}

function mapToCapabilities(cfg) {
  return {
    recolorables: [
      {
        get: () => cfg.bg_color || defaultConfig.bg_color,
        set: (v) => { cfg.bg_color = v; window.elementSdk.setConfig({ bg_color: v }); }
      },
      {
        get: () => cfg.primary_color || defaultConfig.primary_color,
        set: (v) => { cfg.primary_color = v; window.elementSdk.setConfig({ primary_color: v }); }
      },
      {
        get: () => cfg.text_color || defaultConfig.text_color,
        set: (v) => { cfg.text_color = v; window.elementSdk.setConfig({ text_color: v }); }
      }
    ],
    borderables: [],
    fontEditable: {
      get: () => cfg.font_family || defaultConfig.font_family,
      set: (v) => { cfg.font_family = v; window.elementSdk.setConfig({ font_family: v }); }
    },
    fontSizeable: {
      get: () => cfg.font_size || defaultConfig.font_size,
      set: (v) => { cfg.font_size = v; window.elementSdk.setConfig({ font_size: v }); }
    }
  };
}

function mapToEditPanelValues(cfg) {
  return new Map([
    ['page_title', cfg.page_title || defaultConfig.page_title],
    ['subtitle', cfg.subtitle || defaultConfig.subtitle]
  ]);
}

// Initialize
if (window.elementSdk) {
  window.elementSdk.init({
    defaultConfig,
    onConfigChange,
    mapToCapabilities,
    mapToEditPanelValues
  });
}

renderAll();

// Update timestamp
const now = new Date();
document.getElementById('generated-at').textContent = `Gerado em ${now.toLocaleDateString('pt-BR')} ${now.toLocaleTimeString('pt-BR', {hour: '2-digit', minute: '2-digit'})}`;

// Particle system
function createParticles() {
  const particleCount = 30;
  const colors = ['var(--accent-blue)', 'var(--accent-purple)', 'var(--accent-cyan)'];
  
  for (let i = 0; i < particleCount; i++) {
    const particle = document.createElement('div');
    particle.className = 'particle';
    particle.style.left = Math.random() * 100 + '%';
    particle.style.background = colors[Math.floor(Math.random() * colors.length)];
    particle.style.animation = `float ${15 + Math.random() * 10}s linear infinite`;
    particle.style.animationDelay = Math.random() * 5 + 's';
    particle.style.width = particle.style.height = (1 + Math.random() * 2) + 'px';
    document.body.appendChild(particle);
  }
}

createParticles();

// Smooth scroll for sidebar navigation
document.addEventListener('click', (e) => {
  const link = e.target.closest('a[href^="#query-"]');
  if (link) {
    e.preventDefault();
    const targetId = link.getAttribute('href').substring(1);
    const target = document.getElementById(targetId);
    if (target) {
      target.scrollIntoView({ behavior: 'smooth', block: 'start' });
      
      // Update active state
      document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
      link.classList.add('active');
    }
  }
});

// Intersection Observer for active sidebar item
const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      const id = entry.target.id;
      document.querySelectorAll('.sidebar-item').forEach(item => {
        if (item.getAttribute('href') === `#${id}`) {
          document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
          item.classList.add('active');
        }
      });
    }
  });
}, { threshold: 0.5 });

// Observe all query cards
setTimeout(() => {
  document.querySelectorAll('[id^="query-"]').forEach(card => {
    observer.observe(card);
  });
}, 1000);
</script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9c186b32b0ea4f7e',t:'MTc2OTAxNTM2MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>